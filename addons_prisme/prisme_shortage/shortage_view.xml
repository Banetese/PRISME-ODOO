<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
	
 		<record id="view_prisme_product_template_shortage_button_form" model="ir.ui.view">
            <field name="name">prisme.product.template.shortage_button_form</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_only_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//div[@name='buttons']" position="inside">
                    <button class="oe_inline oe_stat_button" icon="fa-hourglass-end" string="Product shortage" name="action_view_product_shortage" type="object">
                        
                    </button>
                </xpath>
            </field>
        </record>
        
        <record id="view_prisme_product_product_shortage_button_form" model="ir.ui.view">
            <field name="name">prisme.product.product.shortage_button_form</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//div[@name='buttons']" position="inside">
                    <button class="oe_inline oe_stat_button" icon="fa-glass" string="Product shortage" name="action_view_product_shortage" type="object">
                        
                    </button>
                </xpath>
            </field>
        </record>
		
	 	<record id="wizard_prisme_shortage" model="ir.ui.view">
			<field name="name">prisme.shortage.wizard.tree</field>
			<field name="model">prisme.shortage.wizard</field>
			<field name="type">tree</field>
            <field name="view_mode">tree</field>
			<field name="arch" type="xml">
				<tree string="Shortable" colors="gray:state in ('actual');darkred:sign=='-';darkgreen:sign=='+';red:qtysum&lt;0">
					<field name="origin"/>
	        		<field name="partner_id"/>
	        		<field name="product_id"/>
	        		<field name="product_qty"/>
					<field name="qtysum"/>
					<field name="qtysumshort"/>
	        		<field name="location_id"/>
	        		<field name="location_dest_id"/>
	        		<field name="date"/>
	        		<field name="state"/>
					<field name="sign" invisible="1" />
				</tree>
			</field>
		</record>
	
 	    <record model="ir.actions.act_window" id="action_prisme_product_template_shortage">
            <field name="name">Product Shortage</field>
            <!-- <field name="context">{"template_id": active_id}</field> -->
            <field name="res_model">prisme.shortage.wizard</field>
            <field name="src_model">product.template</field>
            <field name="view_id" ref="wizard_prisme_shortage"/>
            <field name="view_mode">tree</field>
        </record>
        
        <record model="ir.actions.act_window" id="action_prisme_product_product_shortage">
            <field name="context">{"product_id": active_id}</field>
            <field name="domain">[('create_uid','=',uid),]</field>
            <field name="name">Product Shortage</field>
            <field name="res_model">prisme.shortage.wizard</field>
            <field name="src_model">product.product</field>
            <field name="view_id" ref="wizard_prisme_shortage"/>
            <field name="view_mode">tree</field>
        </record>
        
        

		


		<record id="all_prisme_shortage" model="ir.ui.view">
                <field name="name">prisme.shortage.all.tree</field>
                <field name="model">prisme.shortage.all</field>
                <field name="arch" type="xml">
                <tree string="Shortable for all products" colors="gray:state in ('actual');darkred:sign=='-';darkgreen:sign=='+';red:qtysum&lt;0" >
                                <field name="origin"/>
                                <field name="partner_id"/>
                                <field name="product_id"/>
                                <field name="product_qty"/>
                                <field name="qtysum" />
                                <field name="qtysumshort"/>
                                <field name="location_id"/>
                                <field name="location_dest_id"/>
                                <field name="date"/>
                                <field name="state"/>
                                <field name="sign" invisible="1" />
                </tree>
                </field>
		</record>
		
		<record id="view_prisme_shortage_all_search" model="ir.ui.view">
			<field name="name">prisme.shortage.all.search</field> 
			<field name="model">prisme.shortage.all</field> 
			<field name="type">search</field> 
			<field eval="3" name="priority" /> 
			<field name="arch" type="xml">
				<search string="Products shortage">
						<field name="origin" />
						<field name="partner_id" /> 
						<field name="product_id" /> 
						<field name="state" /> 
						<field name="date" />
				</search>
            </field>
        </record>
		
        <record model="ir.actions.act_window" id="action_prisme_shortage_all">
                <field name="name">All product shortage</field>
                <field name="res_model">prisme.shortage.all</field>
                <field name="domain">[('create_uid', '=', uid),]</field>
				<field name="context">{'group_by':['product_id'],}</field> 
                <field name="view_type">form</field>
                <field name="view_mode">tree, form</field>
                <field name="view_id" ref="all_prisme_shortage" />
				<field name="search_view_id" ref="view_prisme_shortage_all_search" />
        </record>
        <menuitem
                id="menu_view_prisme_shortage_all"
                parent="stock.menu_traceability"
                name="All product shortage"
                action="action_prisme_shortage_all"
                sequence="99"
        />
</data>
</openerp>
